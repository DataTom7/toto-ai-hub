# Firebase App Hosting Configuration - Production Environment
# toto-ai project configuration

runConfig:
  minInstances: 2
  maxInstances: 20
  concurrency: 100
  cpu: 2
  memoryMiB: 2048

scripts:
  buildCommand: npm ci && npm run build
  runCommand: npm start

env:
  # Google AI API Key for Gemini
  - variable: GOOGLE_AI_API_KEY
    secret: toto-ai-hub-google-ai-key-v2
    availability:
      - BUILD
      - RUNTIME

  # Firebase Configuration
  - variable: FIREBASE_PROJECT_ID
    value: toto-ai-hub
    availability:
      - BUILD
      - RUNTIME

  # Environment
  - variable: NODE_ENV
    value: "production"
    availability:
      - BUILD
      - RUNTIME

  # Toto App Staging Service Account (entire JSON as secret)
  - variable: TOTO_APP_STG_SERVICE_ACCOUNT_KEY
    secret: toto-app-stg-service-account
    availability:
      - BUILD
      - RUNTIME

  # Toto BO Service Account (entire JSON as secret) - for shared KB access
  # This allows toto-ai-hub to access the shared KB in toto-bo Firestore
  # Both staging and production instances will use this to access the same KB
  - variable: TOTO_BO_SERVICE_ACCOUNT_KEY
    secret: toto-bo-service-account
    availability:
      - BUILD
      - RUNTIME

outputFiles:
  serverApp:
    include: [dist, package.json, package-lock.json, server.js, public, node_modules]
